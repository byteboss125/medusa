---
displayed_sidebar: servicesSidebar
---

import ParameterTypes from "@site/src/components/ParameterTypes"

# FulfillmentProviderService

Helps retrieve fulfillment providers

## Constructors

### constructor

**new FulfillmentProviderService**(`container`)

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "container",
    "type": "[`FulfillmentProviderContainer`](../types/FulfillmentProviderContainer.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

## Properties

<ParameterTypes parameters={[
  {
    "name": "__configModule__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "__container__",
    "type": "`any`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "__moduleDeclaration__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "container_",
    "type": "[`FulfillmentProviderContainer`](../types/FulfillmentProviderContainer.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "fulfillmentProviderRepository_",
    "type": "`Repository`<[`FulfillmentProvider`](FulfillmentProvider.mdx)\\>",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "manager_",
    "type": "`EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "transactionManager_",
    "type": "`undefined` \\| `EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

## Accessors

### activeManager\_

`Protected` `get` **activeManager_**(): `EntityManager`

#### Returns

`EntityManager`

<ParameterTypes parameters={[
  {
    "name": "EntityManager",
    "type": "`EntityManager`",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

## Methods

### atomicPhase\_

`Protected` **atomicPhase_**<`TResult`, `TError`\>(`work`, `isolationOrErrorHandler?`, `maybeErrorHandlerOrDontFail?`): `Promise`<`TResult`\>

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

<ParameterTypes parameters={[
  {
    "name": "TResult",
    "type": "`object`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "TError",
    "type": "`object`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "work",
    "type": "(`transactionManager`: `EntityManager`) => `Promise`<`TResult`\\>",
    "description": "the transactional work to be done",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "isolationOrErrorHandler",
    "type": "`IsolationLevel` \\| (`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "the isolation level to be used for the work.",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "maybeErrorHandlerOrDontFail",
    "type": "(`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "Potential error handler",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`TResult`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`TResult`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the result of the transactional work",
    "expandable": false,
    "children": []
  }
]} />

___

### calculatePrice

**calculatePrice**(`option`, `data`, `cart?`): `Promise`<`number`\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "option",
    "type": "[`ShippingOption`](ShippingOption.mdx)",
    "description": "A Shipping Option represents a way in which an Order or Return can be shipped. Shipping Options have an associated Fulfillment Provider that will be used when the fulfillment of an Order is initiated. Shipping Options themselves cannot be added to Carts, but serve as a template for Shipping Methods. This distinction makes it possible to customize individual Shipping Methods with additional information.",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "data",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "cart",
    "type": "[`Order`](Order.mdx) \\| [`Cart`](Cart.mdx)",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`number`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`number`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### canCalculate

**canCalculate**(`option`): `Promise`<`boolean`\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "option",
    "type": "[`CalculateOptionPriceInput`](../types/CalculateOptionPriceInput.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`boolean`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`boolean`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### cancelFulfillment

**cancelFulfillment**(`fulfillment`): `Promise`<[`Fulfillment`](Fulfillment.mdx)\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fulfillment",
    "type": "[`Fulfillment`](Fulfillment.mdx)",
    "description": "A Fulfillment is created once an admin can prepare the purchased goods. Fulfillments will eventually be shipped and hold information about how to track shipments. Fulfillments are created through a fulfillment provider, which typically integrates a third-party shipping service. Fulfillments can be associated with orders, claims, swaps, and returns.",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<[`Fulfillment`](Fulfillment.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Fulfillment`](Fulfillment.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### createFulfillment

**createFulfillment**(`method`, `items`, `order`, `fulfillment`): `Promise`<Record<`string`, `unknown`\>\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "method",
    "type": "[`ShippingMethod`](ShippingMethod.mdx)",
    "description": "A Shipping Method represents a way in which an Order or Return can be shipped. Shipping Methods are created from a Shipping Option, but may contain additional details that can be necessary for the Fulfillment Provider to handle the shipment. If the shipping method is created for a return, it may be associated with a claim or a swap that the return is part of.",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "items",
    "type": "[`LineItem`](LineItem.mdx)[]",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "order",
    "type": "[`CreateFulfillmentOrder`](../types/CreateFulfillmentOrder.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "fulfillment",
    "type": "[`Omit`](../types/Omit.mdx)<[`Fulfillment`](Fulfillment.mdx), ``\"beforeInsert\"``\\>",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<Record<`string`, `unknown`\>\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<Record<`string`, `unknown`\\>\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### createReturn

**createReturn**(`returnOrder`): `Promise`<Record<`string`, `unknown`\>\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "returnOrder",
    "type": "[`CreateReturnType`](../types/CreateReturnType.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<Record<`string`, `unknown`\>\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<Record<`string`, `unknown`\\>\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### list

**list**(): `Promise`<[`FulfillmentProvider`](FulfillmentProvider.mdx)[]\>

#### Returns

`Promise`<[`FulfillmentProvider`](FulfillmentProvider.mdx)[]\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`FulfillmentProvider`](FulfillmentProvider.mdx)[]\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### listFulfillmentOptions

**listFulfillmentOptions**(`providerIds`): `Promise`<[`FulfillmentOptions`](../types/FulfillmentOptions.mdx)[]\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "providerIds",
    "type": "`string`[]",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<[`FulfillmentOptions`](../types/FulfillmentOptions.mdx)[]\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`FulfillmentOptions`](../types/FulfillmentOptions.mdx)[]\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### registerInstalledProviders

**registerInstalledProviders**(`providers`): `Promise`<`void`\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "providers",
    "type": "`string`[]",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`void`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`void`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### retrieveDocuments

**retrieveDocuments**(`providerId`, `fulfillmentData`, `documentType`): `Promise`<`any`\>

Fetches documents from the fulfillment provider

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "providerId",
    "type": "`string`",
    "description": "the id of the provider",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "fulfillmentData",
    "type": "Record<`string`, `unknown`\\>",
    "description": "the data relating to the fulfillment",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "documentType",
    "type": "``\"label\"`` \\| ``\"invoice\"``",
    "description": "the typ of",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`any`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`any`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "document to fetch",
    "expandable": false,
    "children": []
  }
]} />

___

### retrieveProvider

**retrieveProvider**(`providerId`): `any`

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "providerId",
    "type": "`string`",
    "description": "the provider id",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`any`

<ParameterTypes parameters={[
  {
    "name": "any",
    "type": "`any`",
    "optional": true,
    "defaultValue": "",
    "description": "the payment fulfillment provider",
    "expandable": false,
    "children": []
  }
]} />

___

### shouldRetryTransaction\_

`Protected` **shouldRetryTransaction_**(`err`): `boolean`

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "err",
    "type": "Record<`string`, `unknown`\\> \\| { `code`: `string`  }",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`boolean`

<ParameterTypes parameters={[
  {
    "name": "boolean",
    "type": "`boolean`",
    "optional": true,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### validateFulfillmentData

**validateFulfillmentData**(`option`, `data`, `cart`): `Promise`<Record<`string`, `unknown`\>\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "option",
    "type": "[`ShippingOption`](ShippingOption.mdx)",
    "description": "A Shipping Option represents a way in which an Order or Return can be shipped. Shipping Options have an associated Fulfillment Provider that will be used when the fulfillment of an Order is initiated. Shipping Options themselves cannot be added to Carts, but serve as a template for Shipping Methods. This distinction makes it possible to customize individual Shipping Methods with additional information.",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "data",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "cart",
    "type": "Record<`string`, `unknown`\\> \\| [`Cart`](Cart.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<Record<`string`, `unknown`\>\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<Record<`string`, `unknown`\\>\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### validateOption

**validateOption**(`option`): `Promise`<`boolean`\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "option",
    "type": "[`ShippingOption`](ShippingOption.mdx)",
    "description": "A Shipping Option represents a way in which an Order or Return can be shipped. Shipping Options have an associated Fulfillment Provider that will be used when the fulfillment of an Order is initiated. Shipping Options themselves cannot be added to Carts, but serve as a template for Shipping Methods. This distinction makes it possible to customize individual Shipping Methods with additional information.",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

`Promise`<`boolean`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`boolean`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### withTransaction

**withTransaction**(`transactionManager?`): [`FulfillmentProviderService`](FulfillmentProviderService.mdx)

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "transactionManager",
    "type": "`EntityManager`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

[`FulfillmentProviderService`](FulfillmentProviderService.mdx)

<ParameterTypes parameters={[
  {
    "name": "FulfillmentProviderService",
    "type": "[`FulfillmentProviderService`](FulfillmentProviderService.mdx)",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />
