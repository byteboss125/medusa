---
displayed_sidebar: jsClientSidebar
---

import ParameterTypes from "@site/src/components/ParameterTypes"

# IFileService

## Implemented by

- [`AbstractFileService`](../classes/internal.internal.AbstractFileService.mdx)

## Properties

<ParameterTypes parameters={[
  {
    "name": "__configModule__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "__container__",
    "type": "`any`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "__moduleDeclaration__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "manager_",
    "type": "`EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "transactionManager_",
    "type": "`undefined` \\| `EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

## Accessors

### activeManager\_

#### Returns

<ParameterTypes parameters={[
  {
    "name": "EntityManager",
    "type": "`EntityManager`",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

## Methods

### atomicPhase\_

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "work",
    "type": "(`transactionManager`: `EntityManager`) => `Promise`<`TResult`\\>",
    "description": "the transactional work to be done",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "__type",
        "type": "(`transactionManager`: `EntityManager`) => `Promise`<`TResult`\\>",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  },
  {
    "name": "isolationOrErrorHandler",
    "type": "`IsolationLevel` \\| (`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "the isolation level to be used for the work.",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  },
  {
    "name": "maybeErrorHandlerOrDontFail",
    "type": "(`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "Potential error handler",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "__type",
        "type": "(`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`TResult`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the result of the transactional work",
    "expandable": false,
    "children": []
  }
]} />

___

### delete

remove file from fileservice

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fileData",
    "type": "[`DeleteFileType`](../../modules/internal.mdx#deletefiletype)",
    "description": "Remove file described by record",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "fileKey",
        "type": "`string`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`void`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### getDownloadStream

download file from fileservice as stream

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fileData",
    "type": "[`GetUploadedFileType`](../../modules/internal.mdx#getuploadedfiletype)",
    "description": "file metadata relevant for fileservice to download the file",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "fileKey",
        "type": "`string`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "isPrivate",
        "type": "`boolean`",
        "description": "",
        "optional": true,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`ReadableStream`](internal.ReadableStream-1.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "readable stream of the file to download",
    "expandable": false,
    "children": [
      {
        "name": "ReadableStream",
        "type": "[`ReadableStream`](internal.ReadableStream-1.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

___

### getPresignedDownloadUrl

Generate a presigned download url to obtain a file

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fileData",
    "type": "[`GetUploadedFileType`](../../modules/internal.mdx#getuploadedfiletype)",
    "description": "file metadata relevant for fileservice to download the file",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "fileKey",
        "type": "`string`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "isPrivate",
        "type": "`boolean`",
        "description": "",
        "optional": true,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`string`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "presigned url to download the file",
    "expandable": false,
    "children": [
      {
        "name": "string",
        "type": "`string`",
        "optional": true,
        "defaultValue": "",
        "description": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

___

### getUploadStreamDescriptor

upload file to fileservice from stream

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fileData",
    "type": "[`UploadStreamDescriptorType`](../../modules/internal.mdx#uploadstreamdescriptortype)",
    "description": "file metadata relevant for fileservice to create and upload the file",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "ext",
        "type": "`string`",
        "description": "",
        "optional": true,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "isPrivate",
        "type": "`boolean`",
        "description": "",
        "optional": true,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "name",
        "type": "`string`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`FileServiceGetUploadStreamResult`](../../modules/internal.mdx#fileservicegetuploadstreamresult)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": [
      {
        "name": "FileServiceGetUploadStreamResult",
        "type": "`object`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": [
          {
            "name": "fileKey",
            "type": "`string`",
            "description": "",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          },
          {
            "name": "promise",
            "type": "`Promise`<`any`\\>",
            "description": "",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          },
          {
            "name": "url",
            "type": "`string`",
            "description": "",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          },
          {
            "name": "writeStream",
            "type": "[`PassThrough`](../classes/internal.PassThrough.mdx)",
            "description": "",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": [
              {
                "name": "allowHalfOpen",
                "type": "`boolean`",
                "description": "If `false` then the stream will automatically end the writable side when the readable side ends. Set initially by the `allowHalfOpen` constructor option, which defaults to `true`. This can be changed manually to change the half-open behavior of an existing`Duplex` stream instance, but must be changed before the `'end'` event is emitted.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "closed",
                "type": "`boolean`",
                "description": "Is `true` after `'close'` has been emitted.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "destroyed",
                "type": "`boolean`",
                "description": "Is `true` after `readable.destroy()` has been called.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "errored",
                "type": "``null`` \\| [`Error`](../../modules/internal.mdx#error)",
                "description": "Returns error if the stream has been destroyed with an error.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readable",
                "type": "`boolean`",
                "description": "Is `true` if it is safe to call `readable.read()`, which means the stream has not been destroyed or emitted `'error'` or `'end'`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableAborted",
                "type": "`boolean`",
                "description": "Returns whether the stream was destroyed or errored before emitting `'end'`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableDidRead",
                "type": "`boolean`",
                "description": "Returns whether `'data'` has been emitted.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableEncoding",
                "type": "``null`` \\| [`BufferEncoding`](../../modules/internal.mdx#bufferencoding)",
                "description": "Getter for the property `encoding` of a given `Readable` stream. The `encoding`property can be set using the `readable.setEncoding()` method.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableEnded",
                "type": "`boolean`",
                "description": "Becomes `true` when `'end'` event is emitted.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableFlowing",
                "type": "``null`` \\| `boolean`",
                "description": "This property reflects the current state of a `Readable` stream as described in the `Three states` section.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableHighWaterMark",
                "type": "`number`",
                "description": "Returns the value of `highWaterMark` passed when creating this `Readable`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableLength",
                "type": "`number`",
                "description": "This property contains the number of bytes (or objects) in the queue ready to be read. The value provides introspection data regarding the status of the `highWaterMark`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "readableObjectMode",
                "type": "`boolean`",
                "description": "Getter for the property `objectMode` of a given `Readable` stream.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writable",
                "type": "`boolean`",
                "description": "Is `true` if it is safe to call `writable.write()`, which means the stream has not been destroyed, errored, or ended.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableCorked",
                "type": "`number`",
                "description": "Number of times `writable.uncork()` needs to be called in order to fully uncork the stream.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableEnded",
                "type": "`boolean`",
                "description": "Is `true` after `writable.end()` has been called. This property does not indicate whether the data has been flushed, for this use `writable.writableFinished` instead.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableFinished",
                "type": "`boolean`",
                "description": "Is set to `true` immediately before the `'finish'` event is emitted.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableHighWaterMark",
                "type": "`number`",
                "description": "Return the value of `highWaterMark` passed when creating this `Writable`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableLength",
                "type": "`number`",
                "description": "This property contains the number of bytes (or objects) in the queue ready to be written. The value provides introspection data regarding the status of the `highWaterMark`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableNeedDrain",
                "type": "`boolean`",
                "description": "Is `true` if the stream's buffer has been full and stream will emit `'drain'`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "writableObjectMode",
                "type": "`boolean`",
                "description": "Getter for the property `objectMode` of a given `Writable` stream.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "captureRejectionSymbol",
                "type": "typeof [`captureRejectionSymbol`](../classes/internal.Socket.mdx#capturerejectionsymbol)",
                "description": "Value: `Symbol.for('nodejs.rejection')` See how to write a custom `rejection handler`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "captureRejections",
                "type": "`boolean`",
                "description": "Value: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) Change the default `captureRejections` option on all new `EventEmitter` objects.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "defaultMaxListeners",
                "type": "`number`",
                "description": "By default, a maximum of `10` listeners can be registered for any single event. This limit can be changed for individual `EventEmitter` instances using the `emitter.setMaxListeners(n)` method. To change the default for _all_`EventEmitter` instances, the `events.defaultMaxListeners`property can be used. If this value is not a positive number, a `RangeError`is thrown. Take caution when setting the `events.defaultMaxListeners` because the change affects _all_`EventEmitter` instances, including those created before the change is made. However, calling `emitter.setMaxListeners(n)` still has precedence over `events.defaultMaxListeners`. This is not a hard limit. The `EventEmitter` instance will allow more listeners to be added but will output a trace warning to stderr indicating that a \"possible EventEmitter memory leak\" has been detected. For any single`EventEmitter`, the `emitter.getMaxListeners()` and `emitter.setMaxListeners()`methods can be used to temporarily avoid this warning: ```js import { EventEmitter } from 'node:events'; const emitter = new EventEmitter(); emitter.setMaxListeners(emitter.getMaxListeners() + 1); emitter.once('event', () => { // do stuff emitter.setMaxListeners(Math.max(emitter.getMaxListeners() - 1, 0)); }); ``` The `--trace-warnings` command-line flag can be used to display the stack trace for such warnings. The emitted warning can be inspected with `process.on('warning')` and will have the additional `emitter`, `type`, and `count` properties, referring to the event emitter instance, the event's name and the number of attached listeners, respectively. Its `name` property is set to `'MaxListenersExceededWarning'`.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              },
              {
                "name": "errorMonitor",
                "type": "typeof [`errorMonitor`](../classes/internal.Socket.mdx#errormonitor)",
                "description": "This symbol shall be used to install a listener for only monitoring `'error'`events. Listeners installed using this symbol are called before the regular`'error'` listeners are called. Installing a listener using this symbol does not change the behavior once an`'error'` event is emitted. Therefore, the process will still crash if no regular `'error'` listener is installed.",
                "optional": false,
                "defaultValue": "",
                "expandable": false,
                "children": []
              }
            ]
          }
        ]
      }
    ]
  }
]} />

___

### shouldRetryTransaction\_

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "err",
    "type": "Record<`string`, `unknown`\\> \\| { `code`: `string`  }",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "boolean",
    "type": "`boolean`",
    "optional": true,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />

___

### upload

upload file to fileservice

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "file",
    "type": "`File`",
    "description": "Multer file from express multipart/form-data",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "lastModified",
        "type": "`number`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/lastModified)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "name",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/name)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "size",
        "type": "`number`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/size)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "type",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/type)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "webkitRelativePath",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/webkitRelativePath)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`FileServiceUploadResult`](../../modules/internal.mdx#fileserviceuploadresult)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": [
      {
        "name": "FileServiceUploadResult",
        "type": "`object`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": [
          {
            "name": "key",
            "type": "`string`",
            "description": "The key of the file that is identifiable by the file service. It can be used later to retrieve or manipulate the file.",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          },
          {
            "name": "url",
            "type": "`string`",
            "description": "The URL of the uploaded file.",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          }
        ]
      }
    ]
  }
]} />

___

### uploadProtected

upload private file to fileservice

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "file",
    "type": "`File`",
    "description": "Multer file from express multipart/form-data",
    "optional": false,
    "defaultValue": "",
    "expandable": false,
    "children": [
      {
        "name": "lastModified",
        "type": "`number`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/lastModified)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "name",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/name)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "size",
        "type": "`number`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/size)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "type",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/type)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      },
      {
        "name": "webkitRelativePath",
        "type": "`string`",
        "description": "[MDN Reference](https://developer.mozilla.org/docs/Web/API/File/webkitRelativePath)",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": []
      }
    ]
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`FileServiceUploadResult`](../../modules/internal.mdx#fileserviceuploadresult)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": [
      {
        "name": "FileServiceUploadResult",
        "type": "`object`",
        "description": "",
        "optional": false,
        "defaultValue": "",
        "expandable": false,
        "children": [
          {
            "name": "key",
            "type": "`string`",
            "description": "The key of the file that is identifiable by the file service. It can be used later to retrieve or manipulate the file.",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          },
          {
            "name": "url",
            "type": "`string`",
            "description": "The URL of the uploaded file.",
            "optional": false,
            "defaultValue": "",
            "expandable": false,
            "children": []
          }
        ]
      }
    ]
  }
]} />

___

### withTransaction

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "transactionManager",
    "type": "`EntityManager`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "expandable": false,
    "children": []
  }
]} />

#### Returns

<ParameterTypes parameters={[
  {
    "name": "IFileService",
    "type": "[`IFileService`](internal.internal.IFileService.mdx)",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "expandable": false,
    "children": []
  }
]} />
