---
displayed_sidebar: jsClientSidebar
---

import ParameterTypes from "@site/src/components/ParameterTypes"

# SwapService

[internal](../../admin_discounts/modules/admin_discounts.internal.mdx).[internal](../modules/admin_discounts.internal.internal.mdx).SwapService

Handles swaps

## Properties

<ParameterTypes parameters={[
  {
    "name": "__configModule__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "__container__",
    "type": "`any`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "__moduleDeclaration__",
    "type": "Record<`string`, `unknown`\\>",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "cartService_",
    "type": "[`CartService`](admin_discounts.internal.internal.CartService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "customShippingOptionService_",
    "type": "[`CustomShippingOptionService`](admin_discounts.internal.internal.CustomShippingOptionService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "eventBus_",
    "type": "[`EventBusService`](admin_discounts.internal.internal.EventBusService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "fulfillmentService_",
    "type": "[`FulfillmentService`](admin_discounts.internal.FulfillmentService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "lineItemAdjustmentService_",
    "type": "[`LineItemAdjustmentService`](admin_discounts.internal.internal.LineItemAdjustmentService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "lineItemService_",
    "type": "[`LineItemService`](admin_discounts.internal.internal.LineItemService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "manager_",
    "type": "`EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "orderService_",
    "type": "[`OrderService`](admin_discounts.internal.internal.OrderService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "paymentProviderService_",
    "type": "[`PaymentProviderService`](admin_discounts.internal.internal.PaymentProviderService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "productVariantInventoryService_",
    "type": "[`ProductVariantInventoryService`](admin_discounts.internal.internal.ProductVariantInventoryService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "returnService_",
    "type": "[`ReturnService`](admin_discounts.internal.internal.ReturnService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "shippingOptionService_",
    "type": "[`ShippingOptionService`](admin_discounts.internal.internal.ShippingOptionService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "swapRepository_",
    "type": "`Repository`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "totalsService_",
    "type": "[`TotalsService`](admin_discounts.internal.internal.TotalsService.mdx)",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "transactionManager_",
    "type": "`undefined` \\| `EntityManager`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events",
    "type": "`object`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.CREATED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.FULFILLMENT_CREATED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.PAYMENT_CAPTURED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.PAYMENT_CAPTURE_FAILED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.PAYMENT_COMPLETED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.PROCESS_REFUND_FAILED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.RECEIVED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.REFUND_PROCESSED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "Events.SHIPMENT_CREATED",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

## Accessors

### activeManager\_

`Protected` `get` **activeManager_**(): `EntityManager`

#### Returns

`EntityManager`

<ParameterTypes parameters={[
  {
    "name": "EntityManager",
    "type": "`EntityManager`",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "children": []
  }
]} />

#### Inherited from

TransactionBaseService.activeManager\_

## Methods

### areReturnItemsValid

`Protected` **areReturnItemsValid**(`returnItems`): `Promise`<`boolean`\>

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "returnItems",
    "type": "[`WithRequiredProperty`](../modules/admin_discounts.internal.internal.mdx#withrequiredproperty)<[`Partial`](../../admin_discounts/modules/admin_discounts.internal.mdx#partial)<[`ReturnItem`](admin_collections.internal.ReturnItem.mdx)\\>, ``\"item_id\"``\\>[]",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<`boolean`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`boolean`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "children": [
      {
        "name": "boolean",
        "type": "`boolean`",
        "optional": true,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### atomicPhase\_

`Protected` **atomicPhase_**<`TResult`, `TError`\>(`work`, `isolationOrErrorHandler?`, `maybeErrorHandlerOrDontFail?`): `Promise`<`TResult`\>

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

<ParameterTypes parameters={[
  {
    "name": "TResult",
    "type": "`object`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "TError",
    "type": "`object`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "work",
    "type": "(`transactionManager`: `EntityManager`) => `Promise`<`TResult`\\>",
    "description": "the transactional work to be done",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "isolationOrErrorHandler",
    "type": "`IsolationLevel` \\| (`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "the isolation level to be used for the work.",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "maybeErrorHandlerOrDontFail",
    "type": "(`error`: `TError`) => `Promise`<`void` \\| `TResult`\\>",
    "description": "Potential error handler",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<`TResult`\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<`TResult`\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the result of the transactional work",
    "children": []
  }
]} />

#### Inherited from

[TransactionBaseService](admin_discounts.internal.internal.TransactionBaseService.mdx).[atomicPhase_](admin_discounts.internal.internal.TransactionBaseService.mdx#atomicphase_)

___

### cancel

**cancel**(`swapId`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Cancels a given swap if possible. A swap can only be canceled if all
related returns, fulfillments, and payments have been canceled. If a swap
is associated with a refund, it cannot be canceled.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the id of the swap to cancel.",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the canceled swap.",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### cancelFulfillment

**cancelFulfillment**(`fulfillmentId`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Cancels a fulfillment (if related to a swap)

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "fulfillmentId",
    "type": "`string`",
    "description": "the ID of the fulfillment to cancel",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "updated swap",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### create

**create**(`order`, `returnItems`, `additionalItems?`, `returnShipping?`, `custom?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Creates a swap from an order, with given return items, additional items
and an optional return shipping method.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "order",
    "type": "[`Order`](admin_collections.internal.Order.mdx)",
    "description": "the order to base the swap off",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "returnItems",
    "type": "[`WithRequiredProperty`](../modules/admin_discounts.internal.internal.mdx#withrequiredproperty)<[`Partial`](../../admin_discounts/modules/admin_discounts.internal.mdx#partial)<[`ReturnItem`](admin_collections.internal.ReturnItem.mdx)\\>, ``\"item_id\"``\\>[]",
    "description": "the items to return in the swap",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "additionalItems",
    "type": "[`Pick`](../../admin_auth/modules/admin_auth.internal.mdx#pick)<[`LineItem`](admin_collections.internal.LineItem.mdx), ``\"variant_id\"`` \\| ``\"quantity\"``\\>[]",
    "description": "the items to send to the customer",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "returnShipping",
    "type": "`object`",
    "description": "an optional shipping method for returning the returnItems",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "returnShipping.option_id",
    "type": "`string`",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "returnShipping.price",
    "type": "`number`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "custom",
    "type": "`object`",
    "description": "contains relevant custom information. This object may include no_notification which will disable sending notification when creating swap. If set, it overrules the attribute inherited from the order",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "custom.allow_backorder",
    "type": "`boolean`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "custom.idempotency_key",
    "type": "`string`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "custom.location_id",
    "type": "`string`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "custom.no_notification",
    "type": "`boolean`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the newly created swap",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### createCart

**createCart**(`swapId`, `customShippingOptions?`, `context?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Creates a cart from the given swap. The cart can be used to pay
for differences associated with the swap. The swap represented by the
swapId must belong to the order. Fails if there is already a cart on the
swap.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the id of the swap to create the cart from",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "customShippingOptions",
    "type": "{ `option_id`: `string` ; `price`: `number`  }[]",
    "description": "the shipping options",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "context",
    "type": "`object`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "context.sales_channel_id",
    "type": "`string`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the swap with its cart_id prop set to the id of the new cart.",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### createFulfillment

**createFulfillment**(`swapId`, `config?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Fulfills the additional items associated with the swap. Will call the
fulfillment providers associated with the shipping methods.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the id of the swap to fulfill,",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "config",
    "type": "[`CreateShipmentConfig`](../../admin_discounts/modules/admin_discounts.internal.mdx#createshipmentconfig)",
    "description": "optional configurations, includes optional metadata to attach to the shipment, and a no_notification flag.",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the updated swap with new status and fulfillments.",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### createShipment

**createShipment**(`swapId`, `fulfillmentId`, `trackingLinks?`, `config?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Marks a fulfillment as shipped and attaches tracking numbers.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the id of the swap that has been shipped.",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "fulfillmentId",
    "type": "`string`",
    "description": "the id of the specific fulfillment that has been shipped",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "trackingLinks",
    "type": "{ `tracking_number`: `string`  }[]",
    "description": "the tracking numbers associated with the shipment",
    "optional": true,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "config",
    "type": "[`CreateShipmentConfig`](../../admin_discounts/modules/admin_discounts.internal.mdx#createshipmentconfig)",
    "description": "optional configurations, includes optional metadata to attach to the shipment, and a noNotification flag.",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the updated swap with new fulfillments and status.",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### deleteMetadata

**deleteMetadata**(`swapId`, `key`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Dedicated method to delete metadata for a swap.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the order to delete metadata from.",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "key",
    "type": "`string`",
    "description": "key for metadata field",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "resolves to the updated result.",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### list

**list**(`selector`, `config?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)[]\>

List swaps.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "selector",
    "type": "[`Selector`](../modules/admin_discounts.internal.internal.mdx#selector)<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "the query object for find",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "config",
    "type": "[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "the configuration used to find the objects. contains relations, skip, and take.",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)[]\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)[]\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the result of the find operation",
    "children": [
      {
        "name": "Swap[]",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)[]",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": [
          {
            "name": "Swap",
            "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
            "optional": false,
            "defaultValue": "",
            "description": "",
            "children": []
          }
        ]
      }
    ]
  }
]} />

___

### listAndCount

**listAndCount**(`selector`, `config?`): `Promise`<[[`Swap`](admin_collections.internal.Swap.mdx)[], `number`]\>

List swaps.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "selector",
    "type": "[`Selector`](../modules/admin_discounts.internal.internal.mdx#selector)<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "the query object for find",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "config",
    "type": "[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "the configuration used to find the objects. contains relations, skip, and take.",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[[`Swap`](admin_collections.internal.Swap.mdx)[], `number`]\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[[`Swap`](admin_collections.internal.Swap.mdx)[], `number`]\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the result of the find operation",
    "children": [
      {
        "name": "Swap[]",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)[]",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      },
      {
        "name": "number",
        "type": "`number`",
        "optional": true,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### processDifference

**processDifference**(`swapId`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Process difference for the requested swap.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "id of a swap being processed",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "processed swap",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### registerCartCompletion

**registerCartCompletion**(`swapId`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Register a cart completion

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "The id of the swap",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "swap related to the cart",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### registerReceived

**registerReceived**(`id`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Registers the swap return items as received so that they cannot be used
as a part of other swaps/returns.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "id",
    "type": "`any`",
    "description": "the id of the order with the swap.",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the resulting order",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### retrieve

**retrieve**(`swapId`, `config?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Retrieves a swap with the given id.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "the id of the swap to retrieve",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "config",
    "type": "[`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>, ``\"select\"``\\> & { `select?`: `string`[]  }",
    "description": "the configuration to retrieve the swap",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the swap",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### retrieveByCartId

**retrieveByCartId**(`cartId`, `relations?`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Retrieves a swap based on its associated cart id

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "cartId",
    "type": "`string`",
    "description": "the cart id that the swap's cart has",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "relations",
    "type": "`string`[]",
    "description": "the relations to retrieve swap",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "the swap",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### shouldRetryTransaction\_

`Protected` **shouldRetryTransaction_**(`err`): `boolean`

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "err",
    "type": "Record<`string`, `unknown`\\> \\| { `code`: `string`  }",
    "description": "",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`boolean`

<ParameterTypes parameters={[
  {
    "name": "boolean",
    "type": "`boolean`",
    "optional": true,
    "defaultValue": "",
    "description": "",
    "children": []
  }
]} />

#### Inherited from

[TransactionBaseService](admin_discounts.internal.internal.TransactionBaseService.mdx).[shouldRetryTransaction_](admin_discounts.internal.internal.TransactionBaseService.mdx#shouldretrytransaction_)

___

### transformQueryForCart

`Protected` **transformQueryForCart**(`config`): [`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\>, ``"select"``\> & { `select?`: `string`[]  } & { `cartRelations`: `undefined` \| `string`[] ; `cartSelects`: `undefined` \| keyof [`Cart`](admin_collections.internal.Cart.mdx)[]  }

Transform find config object for retrieval.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "config",
    "type": "[`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>, ``\"select\"``\\> & { `select?`: `string`[]  }",
    "description": "parsed swap find config",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

[`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\>, ``"select"``\> & { `select?`: `string`[]  } & { `cartRelations`: `undefined` \| `string`[] ; `cartSelects`: `undefined` \| keyof [`Cart`](admin_collections.internal.Cart.mdx)[]  }

<ParameterTypes parameters={[
  {
    "name": "[`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>, ``\"select\"``\\> & { `select?`: `string`[]  } & { `cartRelations`: `undefined` \\| `string`[] ; `cartSelects`: `undefined` \\| keyof [`Cart`](admin_collections.internal.Cart.mdx)[]  }",
    "type": "[`Omit`](../../admin_auth/modules/admin_auth.internal.mdx#omit)<[`FindConfig`](../interfaces/admin_discounts.internal.internal.FindConfig.mdx)<[`Swap`](admin_collections.internal.Swap.mdx)\\>, ``\"select\"``\\> & { `select?`: `string`[]  } & { `cartRelations`: `undefined` \\| `string`[] ; `cartSelects`: `undefined` \\| keyof [`Cart`](admin_collections.internal.Cart.mdx)[]  }",
    "optional": true,
    "defaultValue": "",
    "description": "transformed find swap config",
    "children": []
  }
]} />

___

### update

**update**(`swapId`, `update`): `Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

Update the swap record.

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "swapId",
    "type": "`string`",
    "description": "id of a swap to update",
    "optional": false,
    "defaultValue": "",
    "children": []
  },
  {
    "name": "update",
    "type": "[`Partial`](../../admin_discounts/modules/admin_discounts.internal.mdx#partial)<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "description": "new data",
    "optional": false,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\>

<ParameterTypes parameters={[
  {
    "name": "Promise",
    "type": "`Promise`<[`Swap`](admin_collections.internal.Swap.mdx)\\>",
    "optional": false,
    "defaultValue": "",
    "description": "updated swap record",
    "children": [
      {
        "name": "Swap",
        "type": "[`Swap`](admin_collections.internal.Swap.mdx)",
        "optional": false,
        "defaultValue": "",
        "description": "",
        "children": []
      }
    ]
  }
]} />

___

### withTransaction

**withTransaction**(`transactionManager?`): [`SwapService`](admin_discounts.internal.internal.SwapService.mdx)

#### Parameters

<ParameterTypes parameters={[
  {
    "name": "transactionManager",
    "type": "`EntityManager`",
    "description": "",
    "optional": true,
    "defaultValue": "",
    "children": []
  }
]} />

#### Returns

[`SwapService`](admin_discounts.internal.internal.SwapService.mdx)

<ParameterTypes parameters={[
  {
    "name": "SwapService",
    "type": "[`SwapService`](admin_discounts.internal.internal.SwapService.mdx)",
    "optional": false,
    "defaultValue": "",
    "description": "",
    "children": []
  }
]} />

#### Inherited from

[TransactionBaseService](admin_discounts.internal.internal.TransactionBaseService.mdx).[withTransaction](admin_discounts.internal.internal.TransactionBaseService.mdx#withtransaction)
